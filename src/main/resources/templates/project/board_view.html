<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CollaTool - 게시글 보기</title>
  <!-- Add the Bootstrap CDN link -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Add the Bootstrap Datepicker CSS and JS links -->
  <script type="text/javascript" src="/login/jquery.min.js"></script>
</head>
<body>
<div class="container mt-5">
  <h1 class="text-center mb-4">게시글 보기</h1>
  <form action="/projectRest/board-create" method="post" id="frm_board">
    <input type="hidden" name="bId" id="bId" th:value="${board.bId}">
    <input type="hidden" name="bProjectId" th:value="${board.bProjectId}">
    <input type="hidden" name="bUId" th:value="${board.bUId}">
    <div class="form-group">
      <label for="bTitle">제목</label>
      <input type="text" class="form-control" id="bTitle" name="bTitle" th:value="${board.bTitle}" disabled>
    </div>
    <div class="form-group">
      <label for="bContent">내용</label>
      <textarea class="form-control" id="bContent" name="bContent" th:text="${board.bContent}" disabled></textarea>
    </div>
    <div class="mt-3">
      <button th:if="${uId.equals(board.bUId)}" type="button" class="btn btn-primary mr-2" onclick="btn_submit()">수정</button>
      <button th:if="${uId.equals(board.bUId)}" type="button" class="btn btn-primary mr-2" onclick="btn_delete()">삭제</button>
      <button type="button" class="btn btn-secondary" onclick="window.close()">취소</button>
    </div>
  </form>
  <form id="comment-form">
    <textarea id="comment-text" rows="4" cols="50" placeholder="댓글을 입력하세요..."></textarea>
    <button type="button" onclick="">댓글 작성</button>
  </form>
</div>

<!-- Add the Bootstrap JS and Popper.js CDN links (required for some Bootstrap components) -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<!-- Add the Bootstrap Datepicker JS link -->
<!--  <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.11.0/dist/js/bootstrap-datepicker.min.js"></script>-->
<!-- Add Bootstrap Icons (Bi) for the calendar icon -->
<!--  <script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.24.0/dist/js/bootstrap-icons.min.js"></script>-->
</body>
<script>
  function btn_submit(){
    var bId = $("#bId").val();
    location.href="/project/board-modify/"+bId;
  }
  function btn_delete(){
    var bId = $("#bId").val();
    $.ajax({
        url:"/projectRest/board-delete",
        type:"POST",
        data:{
          bId:bId
        },
        success:function(response){
            alert("삭제성공");
            opener.location.reload();
            window.close();
        },
        error:function(response){
            alert("오류발생");
        }
    });
  }

  function btn_comment(){
    var commentText = $("#comment-text").val();
    if (commentText.trim() !== "") {
      // 댓글 목록에 댓글 추가

      $("#comment-list").append("<div class='comment'>" + commentText + "</div>");
      $("#comment-text").val(""); // 입력 필드 초기화
    }else{
      alert("댓글 내용을 입력해주세요.");
    }
  }
</script>
</html>